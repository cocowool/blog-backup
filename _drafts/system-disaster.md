---
title: RTO/RPO驱动的系统可靠性架构设计
tags:
---

[TOC]

可靠性、可用性、可维护性（Reliability, Availability, Maintainability - RAM）是软件开发过程中的三个重要方面。本文与大家探讨下关于高可靠性的设计，首先来看下关于可靠性的定义。

> Reliability is the probability that a product will continue to work normally over a specified interval of time, under specified conditions. 

通俗点理解就是不管在多糙的环境下产品都能够持续工作的能力，体现出两个要求，一个是能正常工作，不会崩溃或报错，即用户能够得到期望的结果，另一个是可以持续工作，不会夯住，能够扛住压力。系统在面临压力的情况下出现问题是很正常的，如何在出现问题时快速恢复业务，是架构设计时要考虑的重要问题。

## 可靠性的度量指标

传统上系统可靠性的度量指标有两个：（MTTF, Mean time to failure） 和 （MTTR, Mean time to restoration）。

#### MTTF



#### MTTR


与之类似但更为主流的两个指标则是：RTO, Recovery time objective 和 RPO, Recovery point objective。从下面一张图可以直观的了解到两个指标的含义。

#### RTO

RTO(Recovery Time Objective)是恢复时间目标，是可容许服务中断的时间长度。

RTO是反映业务恢复的及时性指标，表示业务从中断到恢复正常所需的时间，RTO数值越小，代表容灾系统的数据恢复能力越强，可以部署很多容灾系统，来获取最小的RTO，但这意味着投入大量资金。提升RTO的常用技术有：磁带恢复、人工迁移、应用系统远程切换。

从业务连续性角度考虑，肯定希望RTO数值越小越好，尤其是很多互联网，中断几分钟都会损失数百万的成交量，这些往往不惜一切代价要确保不中断运行。应用系统的自动切换涉及到网络、服务器、存储等多方面的技术，不管任何一个位置出现了故障，这些部分都会启动软件系统进行切换，可以是设备之间的切换，也可能是集群之间的切换，还可能是异地切换，通过应用系统自动切换将业务转移到其它正常的系统中，然后再对故障设备进行排查。将故障原因找到并排除后，再将业务切回到原有系统中，应用系统切换做得好，这个过程不会引起业务的二次中断，让业务无感知切换。

#### RPO

RPO（Recovery Point Ojbective）是恢复点目标，是指能容忍的最大数据丢失量，是指当业务恢复后，恢复得来的数据所对应时间点，RPO取决于数据恢复到怎样的更新程度，这种更新程度可以是上一周的备份数据，也可以是昨天的数据，这和数据备份的频率有关，为了改进RPO，必然要增加数据备份的频率才行。

RPO是反映恢复数据完整性的指标。在同步数据复制方式下，RPO等于数据传输时延的时间，在异步数据复制方式下，RPO基本为异步传输数据排队的时间。

## 

如今，数据安全的重要对于企业单位来说已不言而喻，说到数据安全，必然绕不过容灾备份，而提到容灾备份，其中有两个关键指标必须有所了解：RTO和RPO。RTO 和 RPO 是灾难恢复方面的重要参考指标。现在企业对业务的连续性有苛刻要求，但故障不可避免，一旦发生了故障就需要启动备份机制，确保业务的连续性，所以现在较为完善的容灾机制，RTO和RPO可以很好地反映出容灾性能如何。这两个参数是在运维过程中，一定要重点关注的指标。这个指标的好与差，是基于现有的各种综合运行情况评估得出的真实结果，反映当前在灾难恢复方面的修复能力。

> 灾备的目的就是，保存系统的核心部分。一个好的灾备方案，就是从失败的基础设施中获取企业最宝贵的数据，然后在新的基础设施上恢复它们。注意，灾备不是为了挽救基础设置，而是为了挽救业务。

## DOO

## NRO

NRO（Network Recovery Objective）是网络恢复目标。是指在灾难发生后切换到灾备中心所需的时间。在这一预定时间内不仅要求将网络连接从数据中心切换到灾备中心，还要使用户的网络访问能够成功地转移到灾备中心。

## 灾备等级能力要求



## 参考资料

1. [灾备系统评价标准](http://www.talkwithtrend.com/Article/32186)
2. [灾备系统建设指标：RTO、RPO](https://blog.csdn.net/weixin_42330461/article/details/80743763)
3. [容错，高可用和灾备](http://www.ruanyifeng.com/blog/2019/11/fault-tolerance.html)
4. [灾备行业最全常用术语](https://www.sohu.com/a/161177892_737713)
5. [Design for Reliability](https://manishsharma.blog/2020/07/28/design-for-reliability-importance-of-rto-and-rpo/)